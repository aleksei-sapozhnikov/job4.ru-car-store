<!DOCTYPE html>

<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <!-- Bootstrap CSS -->
    <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet">
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script crossorigin="anonymous"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script crossorigin="anonymous" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script crossorigin="anonymous" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <!-- Jquery-UI -->
    <link href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <!-- Jquery ajax form -->
    <script crossorigin="anonymous"
            integrity="sha384-FzT3vTVGXqf7wRfy8k4BiyzvbNfeYjK+frTVqZeNDFl8woCbF0CYG6g2fMEFFo/i"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.2.2/jquery.form.min.js"></script>

    <!-- Custom components -->
    <link href="components/car/Item.css" rel="stylesheet" type="text/css">
    <script src="components/car/Item.js" type="text/javascript"></script>

    <title>Images</title>
</head>
<body>

<script>
    $(document).ready(function (e) {
        $("#fupForm").on('submit', function (e) {
            $("#fupForm").attr('disabled', true);
            $('#fupForm').css("opacity", ".5");
            e.preventDefault();
            $.ajax({
                type: 'POST',
                url: 'image',
                data: new FormData(this),
                contentType: false,
                cache: false,
                processData: false,
                success: function (msg) {
                    $('.statusMsg').html('<span style="font-size:18px;color:#34A853">SUCCESS! Server response: ' + msg + '</span>');
                    $('#fupForm').css("opacity", "1");
                    $("#fupForm").attr('disabled', false);
                }
            });
        });

        //file type validation
        $("#file").change(function () {
            var file = this.files[0];
            var imagefile = file.type;
            var match = ["image/jpeg", "image/png", "image/jpg"];
            if (!((imagefile == match[0]) || (imagefile == match[1]) || (imagefile == match[2]))) {
                alert('Please select a valid image file (JPEG/JPG/PNG).');
                $("#file").val('');
                return false;
            }
        });
    });
</script>

<script>
    $(document).ready(function (e) {
        $("#getImage").on('submit', function (e) {
            e.preventDefault();

            $("#test").html(
                '<img src="'
                + 'image?id=' + $("#get_img_id").val()
                + '" height="100%" width="100%">'
            );
        });
    });
</script>

<div class="container">
    <p class="statusMsg"></p>
    <form enctype="multipart/form-data" id="fupForm">
        <div class="form-group">
            <label for="name">NAME</label>
            <input class="form-control" id="name" name="name" placeholder="Enter name" required type="text"/>
        </div>
        <div class="form-group">
            <label for="email">EMAIL</label>
            <input class="form-control" id="email" name="email" placeholder="Enter email" required type="email"/>
        </div>
        <div class="form-group">
            <label for="photo">File</label>
            <input class="form-control" id="photo" name="photo" required type="file"/>
        </div>
        <input class="btn btn-danger submitBtn" name="submit" type="submit" value="SAVE"/>
    </form>
</div>

<div class="container">
    <form enctype="text/plain" id="getImage">
        <div class="form-group">
            <label for="get_img_id">IMAGE ID</label>
            <input class="form-control" id="get_img_id" name="id" placeholder="Enter image id" required type="text"/>
        </div>
        <input class="btn btn-danger submitBtn" name="submit" type="submit" value="GET"/>
    </form>
</div>

<div class="container" id="test" style="width:500px; max-height:10px; height: auto"></div>

</body>
</html>